–•–æ—Ä–æ—à–æ üôå –Ø –ø–µ—Ä–µ–ø–∏—Å–∞–ª —Ç–≤–æ–π –∫–æ–¥ —Ç–∞–∫, —á—Ç–æ–±—ã:

* –ù–∞ **–ü–ö (—à–∏—Ä–æ–∫–∏–µ —ç–∫—Ä–∞–Ω—ã)** –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏ —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ –±—ã–ª–∏ –ø–æ —Ü–µ–Ω—Ç—Ä—É, —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ –¥–ª–∏–Ω–Ω–∞—è.
* –ù–∞ **—Ç–µ–ª–µ—Ñ–æ–Ω–µ** (—É–∑–∫–∏–µ —ç–∫—Ä–∞–Ω—ã) ‚Äî –≤—Å—ë —Å–ª–µ–≤–∞, –∫–∞–∫ —É —Ç–µ–±—è –±—ã–ª–æ.
* –Ø –¥–æ–±–∞–≤–∏–ª —Ä–∞–∑–Ω—ã–µ —Ñ–æ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–æ–∂–µ—à—å —É–±—Ä–∞—Ç—å –ø–æ—Ç–æ–º).

–í–æ—Ç –ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∫–æ–¥:

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ICD Search</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { 
      font-family: Arial, sans-serif; 
      padding: 20px; 
      margin: 0; 
    }

    h2 { 
      text-align: left; 
      margin-bottom: 20px; 
    }

    .search-container {
      display: flex;
      justify-content: flex-start;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    input {
      padding: 10px;
      font-size: 16px;
      flex: 1;
      min-width: 200px;
      max-width: 400px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      background-color: #1976d2;
      color: #fff;
      border-radius: 6px;
    }

    table { border-collapse: collapse; margin-top: 20px; width: 100%; }
    td, th { border: 1px solid #999; padding: 5px; text-align: left; vertical-align: middle; }
    td.num-col { width: 60px; text-align: center; }
    .block { margin-bottom: 30px; }
    a { color: blue; text-decoration: underline; }
    #results p { margin: 10px 0; }

    tr.title-row td {
      font-weight: 700;
      font-size: 1.05rem;
      padding: 10px 8px;
      text-align: left;
    }

    tr.section-row td {
      background-color: #eaf2ff !important;
      text-align: left;
    }

    .section-highlight {
      font-weight: bold;
      color: #0d47a1;
    }

    /* –¢–µ–ª–µ—Ñ–æ–Ω (–¥–æ 768px) */
    @media (max-width: 768px) {
      body {
        background-color: #e0f7fa; /* –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ñ–æ–Ω */
      }
      .search-container { 
        flex-direction: column; 
        align-items: stretch; 
      }
      button { 
        width: 100%; 
      }
    }

    /* –ü–ö (–æ—Ç 1024px) */
    @media (min-width: 1024px) {
      body {
        background-color: #f5f5f5; /* –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ñ–æ–Ω */
      }
      h2 {
        text-align: center; /* —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
      }
      .search-container {
        justify-content: center; /* –ø–æ —Ü–µ–Ω—Ç—Ä—É */
      }
      input {
        max-width: 600px; /* –¥–ª–∏–Ω–Ω–æ–µ –ø–æ–ª–µ */
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <h2>–ü–æ–∏—Å–∫ –ø–æ ICD –∫–æ–¥–∞–º</h2>

  <div class="search-container">
    <input type="text" id="codeInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä 721">
    <button id="searchBtn" onclick="searchCode()">–ù–∞–π—Ç–∏</button>
  </div>

  <div id="results"></div>

  <script>
    document.getElementById('codeInput').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') document.getElementById('searchBtn').click();
    });

    function searchCode() {
      const code = document.getElementById('codeInput').value.trim();
      const resultsDiv = document.getElementById('results');
      if (!code) {
        resultsDiv.innerHTML = '<p style="color:red">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥</p>';
        return;
      }
      resultsDiv.innerHTML = '<p>–ò–¥–µ—Ç –ø–æ–∏—Å–∫...</p>';

      google.script.run
        .withSuccessHandler(renderResults)
        .searchICDCodePublic(code);
    }

    function cleanText(val) {
      if (!val) return '';
      return String(val).replace(/[\s\u00A0]+/g, ' ').trim();
    }

    function isSectionText(text) {
      if (!text) return false;
      const t = cleanText(text);
      return /–†–∞–∑–¥–µ–ª\s*[IVX\d]+/i.test(t);
    }

    function highlightSectionText(text) {
      return text.replace(/(–†–∞–∑–¥–µ–ª\s*[IVX\d]+)/i, '<span class="section-highlight">$1</span>');
    }

    function renderResults(results) {
      const container = document.getElementById('results');
      container.innerHTML = '';

      if (!results || results.length === 0) {
        container.innerHTML = '<p>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
        return;
      }

      results.forEach(result => {
        if (result.error) {
          const err = document.createElement('p');
          err.style.color = 'red';
          err.textContent = result.error;
          container.appendChild(err);
          return;
        }

        const blockDiv = document.createElement('div');
        blockDiv.className = 'block';

        const link = document.createElement('a');
        link.href = result.link || '#';
        link.target = '_blank';
        link.textContent = `–õ–∏—Å—Ç: ${result.sheet || ''}, —Å—Ç—Ä–æ–∫–∞ ${result.startRow || ''}`;
        blockDiv.appendChild(link);

        const table = document.createElement('table');

        result.data.forEach((rowObj, idx) => {
          const tr = document.createElement('tr');
          const codeText = cleanText(rowObj.code);
          const nameText = cleanText(rowObj.name);

          if (idx === 0 && (rowObj.code || rowObj.name)) {
            const td = document.createElement('td');
            td.colSpan = 2;
            const titleText = cleanText((rowObj.code ? rowObj.code + ' ' : '') + (rowObj.name || ''));
            if (isSectionText(titleText)) {
              tr.classList.add('section-row');
              td.innerHTML = highlightSectionText(titleText);
            } else {
              td.textContent = titleText;
            }
            tr.classList.add('title-row');
            tr.appendChild(td);
            table.appendChild(tr);
            return;
          }

          const tdCode = document.createElement('td');
          tdCode.className = 'num-col';
          const tdName = document.createElement('td');
          const isSection =
            isSectionText(codeText) ||
            isSectionText(nameText) ||
            isSectionText(codeText + ' ' + nameText);

          if (isSection) {
            tr.classList.add('section-row');
            tdCode.innerHTML = isSectionText(codeText) ? highlightSectionText(codeText) : codeText;
            tdName.innerHTML = isSectionText(nameText) ? highlightSectionText(nameText) : nameText;
          } else {
            tdCode.textContent = codeText;
            tdName.textContent = nameText;
          }

          tr.appendChild(tdCode);
          tr.appendChild(tdName);
          table.appendChild(tr);
        });

        blockDiv.appendChild(table);
        container.appendChild(blockDiv);
      });
    }
  </script>
</body>
</html>
```

---

üëâ –°–µ–π—á–∞—Å –¥–ª—è —Ç–µ—Å—Ç–∞ —è —Å–¥–µ–ª–∞–ª —Ä–∞–∑–Ω—ã–µ —Ñ–æ–Ω—ã: **–≥–æ–ª—É–±–æ–π –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ**, **—Å–µ—Ä—ã–π –Ω–∞ –ü–ö**.
–ï—Å–ª–∏ –ø—Ä–∏ —Å—É–∂–µ–Ω–∏–∏ –æ–∫–Ω–∞ –∏–ª–∏ –≤ —Ä–µ–∂–∏–º–µ DevTools —Ü–≤–µ—Ç–∞ –º–µ–Ω—è—é—Ç—Å—è ‚Äî –∑–Ω–∞—á–∏—Ç –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.

–•–æ—á–µ—à—å, —è –µ—â—ë —Å–¥–µ–ª–∞—é —Ç–∞–∫, —á—Ç–æ–±—ã –Ω–∞ –ø–ª–∞–Ω—à–µ—Ç–µ (768‚Äì1024px) –±—ã–ª —Ç—Ä–µ—Ç–∏–π –≤–∞—Ä–∏–∞–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—Å—ë –ø–æ —Ü–µ–Ω—Ç—Ä—É, –Ω–æ —Å—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ —Å—Ä–µ–¥–Ω—è—è)?
